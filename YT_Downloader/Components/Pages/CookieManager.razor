@page "/cookies"
@rendermode InteractiveServer
@using YT_Downloader.Services
@inject ICookieManager CookieService

<PageTitle>Cookie Manager</PageTitle>

<div class="container">
    <h1>Управление куками</h1>
    <textarea id="cookieText" @bind="cookieContent" rows="20" cols="80" placeholder="Вставьте содержимое файла cookies.txt"></textarea>
    <br>
    <button @onclick="SaveCookies">Сохранить куки</button>
    <div class="progress" id="statusMessage">@saveStatus</div>
</div>

@code {
    private string cookieContent = "";
    private string saveStatus = "";

    protected override async Task OnInitializedAsync()
    {
        await LoadCookies();
    }

    private async Task LoadCookies()
    {
        try
        {
            cookieContent = await CookieService.LoadCookiesAsync();
        }
        catch (Exception ex)
        {
            saveStatus = $"Ошибка загрузки кук: {ex.Message}";
        }
    }

    private async Task SaveCookies()
    {
        try
        {
            await CookieService.SaveCookiesAsync(cookieContent);
            saveStatus = "Куки успешно сохранены!";
        }
        catch (Exception ex)
        {
            saveStatus = $"Ошибка сохранения кук: {ex.Message}";
        }
    }
}
